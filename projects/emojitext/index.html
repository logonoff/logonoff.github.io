<!DOCTYPE html>
<html lang="en" class="shale-v1-light shale-v1-webkit-scrollbar">

	<head>
		<meta charset="utf-8">
		<title>emojitext</title>
		<meta name="description" content="Convert text to aligned emojis that spell out the text for Discord">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://logonoff.co/shalecss/build/shale.css">
		<style>
			html, body, input {
				font-family: var(--shale-v1-font-family), sans-serif;
			}
		</style>
	</head>

	<body>
		<form action="" onsubmit="meme();return false">
			<div class="shale-v1-input">
				<input type="text" id="input" name="input" placeholder="input" onkeyup="meme();" onkeydown="meme();" pattern="^[a-zA-Z0-9 ]+$"><br><br>
			</div>
			<div class="shale-v1-input">
				<input type="text" id="emoji" name="emoji" placeholder="emoji" onkeyup="meme();" onkeydown="meme();" required><br><br>
			</div>
			<div class="shale-v1-input">
				<input type="text" id="space" name="space" placeholder="space" value="   " onkeyup="meme();" onkeydown="meme();" required><br><br>
			</div>
			<div class="shale-v1-input">
				<input class="shale-v1-button" type="submit" value="pain"/>
			</div>
		</form>

		<pre id="text" contenteditable></pre>

		<script>
			/* remove form resubmit dialog - https://stackoverflow.com/a/45656609/ */
			if (window.history.replaceState) {
				window.history.replaceState(null, null, window.location.href);
			}

			/* 0: space, 1: emoji, 2: non-stripping space */
			const letterMap = {
				" ": ["0", "0", "0", "0", "0", "0", "0", "0"],
				"0": ["01110", "10001", "10011", "10101", "11001", "10001", "01110", "00000"],
				"1": ["00100", "01100", "00100", "00100", "00100", "00100", "11111", "00000"],
				"2": ["011100", "100011", "000010", "001100", "010000", "100011", "111110", "000000"],
				"3": ["11100", "00010", "00010", "01100", "00010", "00010", "11100", "00000"],
				"4": ["00011", "00101", "01001", "10001", "11111", "00001", "00001", "00000"],
				"5": ["11111", "10000", "11110", "00001", "00001", "00001", "11110", "00000"],
				"6": ["00110", "01000", "10000", "11110", "10001", "10001", "01110", "00000"],
				"7": ["11111", "10001", "00001", "00010", "00100", "00100", "00100", "00000"],
				"8": ["01110", "10001", "10001", "01110", "10001", "10001", "01110", "00000"],
				"9": ["01110", "10001", "10001", "01111", "00001", "00010", "01100", "00000"],
				"a": ["00000", "00000", "01110", "00001", "01111", "10001", "01111", "00000"],
				"b": ["10000", "10000", "10110", "11001", "10001", "10001", "11110", "00000"],
				"c": ["00000", "00000", "01110", "10001", "10000", "10001", "01110", "00000"],
				"d": ["00001", "00001", "01101", "10011", "10001", "10001", "01111", "00000"],
				"e": ["00000", "00000", "01110", "10001", "11111", "10000", "01111", "00000"],
				"f": ["0011", "0100", "1111", "0100", "0100", "0100", "0100", "0000"],
				"g": ["00000", "00000", "01111", "10001", "10001", "01111", "00001", "11110"],
				"h": ["10000", "10000", "10110", "11001", "10001", "10001", "10001", "00000"],
				"i": ["1", "2", "1", "1", "1", "1", "1", "0"],
				"j": ["00001", "22222", "00001", "00001", "00001", "10001", "10001", "01110"],
				"k": ["1000", "1000", "1001", "1010", "1100", "1010", "1001", "0000"],
				"l": ["10", "10", "10", "10", "10", "10", "01", "00"],
				"m": ["00000", "00000", "11010", "10101", "10101", "10001", "10001", "00000"],
				"n": ["00000", "00000", "11110", "10001", "10001", "10001", "10001", "00000"],
				"o": ["00000", "00000", "01110", "10001", "10001", "10001", "01110", "00000"],
				"p": ["00000", "00000", "10110", "11001", "10001", "11110", "10000", "10000"],
				"q": ["00000", "00000", "01101", "10011", "10001", "01111", "00001", "00001"],
				"r": ["00000", "00000", "10110", "11001", "10000", "10000", "10000", "00000"],
				"s": ["00000", "00000", "01111", "10000", "01110", "00001", "11110", "00000"],
				"t": ["010", "010", "111", "010", "010", "010", "001", "000"],
				"u": ["00000", "00000", "10001", "10001", "10001", "10001", "01111", "00000"],
				"v": ["00000", "00000", "10001", "10001", "10001", "01010", "00100", "00000"],
				"w": ["00000", "00000", "10001", "10001", "10101", "10101", "01111", "00000"],
				"x": ["00000", "00000", "10001", "01010", "00100", "01010", "10001", "00000"],
				"y": ["00000", "00000", "10001", "10001", "10001", "01111", "00001", "11110"],
				"z": ["00000", "00000", "11111", "00010", "00100", "01000", "11111", "00000"],
				"A": ["01110", "10001", "11111", "10001", "10001", "10001", "10001", "00000"],
				"B": ["11110", "10001", "11110", "10001", "10001", "10001", "11110", "00000"],
				"C": ["01110", "10001", "10000", "10000", "10000", "10001", "01110", "00000"],
				"D": ["11110", "10001", "10001", "10001", "10001", "10001", "11110", "00000"],
				"E": ["11111", "10000", "11100", "10000", "10000", "10000", "11111", "00000"],
				"F": ["11111", "10000", "11100", "10000", "10000", "10000", "10000", "00000"],
				"G": ["01111", "10000", "10011", "10001", "10001", "10001", "01110", "00000"],
				"H": ["10001", "10001", "11111", "10001", "10001", "10001", "10001", "00000"],
				"I": ["111", "010", "010", "010", "010", "010", "111", "000"],
				"J": ["000001", "000001", "000001", "000001", "000001", "010001", "001110", "000000"],
				"K": ["10001", "10010", "11100", "10010", "10001", "10001", "10001", "00000"],
				"L": ["10000", "10000", "10000", "10000", "10000", "10000", "11111", "00000"],
				"M": ["10001", "11011", "10101", "10001", "10001", "10001", "10001", "00000"],
				"N": ["10001", "11001", "10101", "10011", "10001", "10001", "10001", "00000"],
				"O": ["01110", "10001", "10001", "10001", "10001", "10001", "01110", "00000"],
				"P": ["11110", "10001", "11110", "10000", "10000", "10000", "10000", "00000"],
				"Q": ["01110", "10001", "10001", "10001", "10001", "10010", "01101", "00000"],
				"R": ["11110", "10001", "11110", "10001", "10001", "10001", "10001", "00000"],
				"S": ["01111", "10000", "01110", "00001", "00001", "10001", "01110", "00000"],
				"T": ["11111", "00100", "00100", "00100", "00100", "00100", "00100", "00000"],
				"U": ["10001", "10001", "10001", "10001", "10001", "10001", "01110", "00000"],
				"V": ["10001", "10001", "10001", "10001", "01010", "01010", "00100", "00000"],
				"W": ["10001", "10001", "10001", "10001", "10101", "11011", "10001", "00000"],
				"X": ["10001", "01010", "00100", "01010", "10001", "10001", "10001", "00000"],
				"Y": ["10001", "01010", "00100", "00100", "00100", "00100", "00100", "00000"],
				"Z": ["11111", "00001", "00010", "00100", "01000", "10000", "11111", "00000"],
			}

			const randomEmoji = () => {
				const emojiCodepointStart = 0x1F600;
				const emojiCodepointEnd = 0x1F64F;
				const randomCodepoint = Math.floor(Math.random() * (emojiCodepointEnd - emojiCodepointStart + 1)) + emojiCodepointStart;
				return String.fromCodePoint(randomCodepoint);
			}

			/* update pre with input */
			function meme() {
				const space = document.getElementById("space").value;
				const text = Array.from(document.getElementById("input").value);
				const emoji = document.getElementById("emoji").value;

				document.getElementById("text").innerHTML = "";

				lines = [[], [], [], [], [], [], [], []]

				text.forEach((char, index) => {
					pixel = letterMap[char] || letterMap[" "];
					lines[0] = ".\n"; /* for discord compact mode */
					for (let i = 1; i <= pixel.length; i++) {
						lines[i] += pixel[i - 1] + "0"; /* 0 is spacer between letters */
					}
				});

				lines.forEach((line, i) => {
					if (line.includes("1") || line.includes(".") || line.includes("2")) {
						lines[i] = line.replaceAll("0", " ").trimRight().replaceAll(" ", space).replaceAll("2", space).replaceAll("1", emoji).replaceAll("undefined", "");

						document.getElementById("text").innerHTML += lines[i] + "<br>";
					}
				});

				/* random accent every time, why not */
				document.querySelector(':root').style.setProperty('--shale-v1-accent', `rgb(${Math.floor(Math.random() * 256)}, ${Math.floor(Math.random() * 256)}, ${Math.floor(Math.random() * 256)})`);
			}

			window.onload = () => {
				/* set default emoji to random emoji on load */
				if (!document.getElementById("emoji").value) {
					document.getElementById("emoji").value = randomEmoji();
				}
				meme();
			}
		</script>

	</body>

</html>
